<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>CarPool309</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="google-signin-client_id" content="887763148938-84hkdvpmfgduvo4k53906b1uhre71anl.apps.googleusercontent.com">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
    <link rel="stylesheet" href="./css/font-awesome.min.css">
		<link href="css/getStarted.css" rel="stylesheet">    
	</head>
	<body>
    <div id="background"></div>
    <!--login modal-->
    <div id="loginModal" class="modal show" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h1 class="text-center">Login</h1>
          </div>
          <div class="modal-body">
              <form class="form col-md-12 center-block">
                <div class="form-group">
                  <input type="text" class="form-control input-lg" placeholder="Email">
                </div>
                <div class="form-group">
                  <input type="password" class="form-control input-lg" placeholder="Password">
                </div>
                <div class="form-group">
                  <button class="btn btn-primary btn-lg btn-block">Sign In</button>
                  <span class="pull-right"><a id="register" href="#">Register</a></span>
                </div>
              </form>
          </div>
          <div class="modal-footer">
            <div class="g-signin2 center" data-onsuccess="onSignIn" data-width="200" data-longtitle="true"></div>
          </div>
      </div>
      </div>
    </div>

    <!--register modal-->
    <div id="registerModal" class="modal hide" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h1 class="text-center">Register</h1>
          </div>
          <div class="modal-body">
              <div class="input-group input-group-lg">
                <span class="input-group-addon" id="sizing-addon1">
                  <i class="fa fa-envelope"></i>
                </span>
                <input id="email" type="text" class="form-control" placeholder="email" aria-describedby="sizing-addon1">
              </div>

              <div class="input-group input-group-lg">
                <span class="input-group-addon" id="sizing-addon1">
                  <i class="fa fa-key"></i>
                </span>
                <input id="password" type="password" class="form-control" placeholder="password" aria-describedby="sizing-addon1">
                <input id="confirm_password" type="password" class="form-control" placeholder="confirm password" aria-describedby="sizing-addon1">
              </div>

              <div class="input-group input-group-lg">
                <span class="input-group-addon" id="sizing-addon1">
                  <i class="fa fa-commenting"></i>
                </span>
                <textarea id="description" class="form-control" rows="3" placeholder="description" required style="height:100px;"></textarea>
              </div>

              <div class="input-group input-group-lg">
                <span class="input-group-addon" id="sizing-addon1">
                  <i class="fa fa-tag"></i>
                </span>
                <input id="displayName" type="text" class="form-control" placeholder="display name" aria-describedby="sizing-addon1">
              </div>

              <div class="input-group input-group-lg">
                <span class="input-group-addon" id="sizing-addon1">
                  <i class="fa fa-picture-o"></i>
                </span>
                  <div class="img_wrapper">
                    <img id="profilePic_preview" alt="profile picture" src="./img/default_profilePic.png"/>
                    <img id="profilePic_buffer" class="hidden" alt="profile picture" src="./img/default_profilePic.png"/>
                  </div>

                <span class="input-group-btn" id="browse-wrapper">
                  <span class="btn btn-info btn-file" id="browser">
                    Browse…
                    <input type="file" id="profilePic" accept=".jpg,.png,.gif">
                  </span>
                </span>
              </div>

              <button id="submit" type="button" class="btn btn-success btn-lg">
                Register
              </button>
          </div>
          <div class="modal-footer">
              <div class="col-md-12">
              <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
              <div class="g-signin2 center" data-onsuccess="onSignIn" data-width="200" data-longtitle="true"></div>
          </div>  
          </div>
      </div>
      </div>
    </div>

	  <!-- script references -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="js/getStarted.js"></script>
    <script>
    function onSignIn(googleUser){
      var profile = googleUser.getBasicProfile();
      var id_token = googleUser.getAuthResponse().id_token;
      var user = {
        email: profile.getEmail(),
        id_token: googleUser.getAuthResponse().id_token,
      }

      $.ajax({
        type: "POST",
        url: "/api/login/?type=google",
        data: {json: JSON.stringify(user)},
        success: function(data){
          alert("OK");
        },
        error: function(jqxhr, textStatus, errorThrown){
          alert(errorThrown);
        }
      });
      $('#register').click(function(){
        $('#loginModal').removeClass('show');
        $('#registerModal').addClass('show');
      });
    } 
    </script>
	</body>
</html>